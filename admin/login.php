<?php
ini_set("session.cookie_httponly", 1); 
function generate_password( $length = 12 ) { 
// 密码字符集，可任意添加你需要的字符 
$chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'; 
$password = ''; 
for ( $i = 0; $i < $length; $i++ ) 
{ 
// 这里提供两种字符获取方式 
// 第一种是使用 substr 截取$chars中的任意一位字符； 
// 第二种是取字符数组 $chars 的任意元素 
// $password .= substr($chars, mt_rand(0, strlen($chars) – 1), 1); 
$password .= $chars[ mt_rand(0, strlen($chars) - 1) ]; 
} 
return $password; 
} 
ini_set("session.cookie_domain",'.w2nd.me');
session_start();
if(isset($_SESSION['username'])){
  header('Location:index.php');
}
$token=generate_password();
$domain='ctf.w2nd.me';
$path='/';
$secure=false;
$httponly=true;
if(!isset($_COOKIE['csrf-token']))
setcookie('csrf-token', $token,time()+3600,  $path,$domain, $secure, $httponly);
?>
<html>
<head>
      	<meta charset="utf-8">
	 <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="//cdn.bootcss.com/jquery/3.2.0/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
      </head>
      <body>
<div class="container" style="margin-top:15%;width:600px;">
<h3>Login</h3>
<form action="confirm.php" method="POST">
  <div>
    <label for="exampleInputName2">Username:</label>
    <input type="text" class="form-control" id="username" name="username" value="test">
  </div>
  <div>
    <label for="exampleInputName2">Password:</label>
    <input type="password" class="form-control" id="password" name="password" value="test">
  </div>
  <input type="hidden" name="csrf-token" value=<?=$_COOKIE['csrf-token']?> >
  <button class="btn btn-default">Sign in</button>
  </form>
</div>
 </body>
 </html>
 